#==============================================================
# ÷������ seq��ȸ
#==============================================================
@sql.notice.getFileSeq
SELECT RNDCALL_FILE_ID_SEQ.NEXT_VALUE AS ID
#==============================================================
# ÷������ ���
#=============================================================== 
@sql.notice.question.getAttachfileInsert
INSERT INTO RNDCALL_FILE (
   	FILE_ID,
	SEQ,
	FILE_NM,
	FILE_UP_PATH,
	FILE_SIZE,
	FILE_DEL_YN,
	REG_ID,
	REG_DT
)VALUES (
	?,
    ?,
    ?,
    ?,
    ?,
    'N',
    ?,
	sysdatetime
)
#==============================================================
# �������� ���
#=============================================================== 
@sql.notice.noticeInsert
INSERT INTO RNDCALL_BOARD_QUESTION (
   TITLE, 
   SEQ, 
   REG_NM, 
   REG_ID, 
   REG_DT, 
   READ_COUNT,  
   INSERT_TYPE, 
   FILE_ID, 
   DEL_YN, 
   CONTENTS, 
   BOARD_TYPE,
   CATEGORY1
   ) 
VALUES (    ?,
?,
?,
?,
sysdatetime,
0,
?,
?,
'N',
CHAR_TO_CLOB(?),
?,
?
)
#==============================================================
# �������� ����Ʈ�� ��ȸ�Ѵ�.
#==============================================================
@sql.notice.question.noticeList
select SEQ, BOARD_TYPE, TITLE, CONTENTS, INSERT_TYPE, decode(file_id,0,'Y','N') As FILE_ID, DEL_YN, READ_COUNT, REG_ID, REG_DT, REG_NM, REG_DT1, CATEGORY1
from 
(SELECT Q.SEQ, 
Q.BOARD_TYPE, 
Q.TITLE, 
CLOB_TO_CHAR(Q.CONTENTS) AS CONTENTS,
Q.INSERT_TYPE, 
(select count(*) from rndcall_file where q.file_id = file_id and file_del_yn='N') AS file_id ,
Q.DEL_YN, 
Q.READ_COUNT, 
Q.REG_ID, TO_CHAR(Q.REG_DT, 'YYYY.MM.DD') AS REG_DT, Q.REG_DT AS REG_DT1,
Q.REG_NM,
Q.CATEGORY1
FROM RNDCALL_BOARD_QUESTION Q
WHERE Q.DEL_YN='N'
 AND Q.BOARD_TYPE='NOTICE' 
 ) A

#==============================================================
# �������� �󼼺��⸦ ��ȸ�Ѵ�.
#==============================================================
@sql.notice.question.view
SELECT  Q.SEQ,             
Q.BOARD_TYPE,       
Q.TITLE,            
CLOB_TO_CHAR(Q.CONTENTS) AS CONTENTS,
Q.FILE_ID AS FILE_ID,          
Q.DEL_YN,           
Q.READ_COUNT,
Q.REG_ID,          
to_char(Q.REG_DT, 'YYYY.MM.DD') AS REG_DT,           
Q.REG_NM,
Q.CATEGORY1
FROM RNDCALL_BOARD_QUESTION Q LEFT OUTER JOIN RNDCALL_FILE F ON Q.SEQ = F.FILE_ID
WHERE Q.DEL_YN='N'
#==============================================================
# ��ȸ�� ������Ʈ
#==============================================================
@sql.notice.question.readCountUpdate
UPDATE RNDCALL_BOARD_QUESTION SET
READ_COUNT = READ_COUNT+1
WHERE SEQ = ?
#==============================================================
# RNDCALL_FILE��ȸ
#==============================================================
@sql.notice.question.fileinfo
SELECT FILE_ID,   SEQ,          FILE_NM,
       FILE_TYPE, FILE_UP_PATH, FILE_DOWN_PATH,
       FILE_SIZE, FILE_DESC,    FILE_DEL_YN
FROM RNDCALL_FILE
WHERE FILE_ID = ?
      AND FILE_DEL_YN='N'
#==============================================================
# �������� �����ϱ�.
#==============================================================
@sql.notice.question.update
UPDATE RNDCALL_BOARD_QUESTION SET
TITLE = ?,
CONTENTS = CHAR_TO_CLOB(?),
EDIT_ID = ?,
EDIT_DT =sysdatetime,
FILE_ID = ?
WHERE SEQ = ?
#==============================================================
# �������� ����
#==============================================================
@sql.notice.question.delete
UPDATE RNDCALL_BOARD_QUESTION SET
    DEL_YN = 'Y' 
WHERE SEQ = ?
#==============================================================
# ÷������ ����(FILE_DEL_YN�÷���  ����(Y)�� ������Ʈ)
#=============================================================== 
@sql.notice.question.getFileDelete
UPDATE RNDCALL_FILE SET
FILE_DEL_YN = 'Y',
EDIT_ID= ?,
EDIT_DT =sysdatetime
WHERE FILE_ID=? 
      AND SEQ= ?